- rules:
  - ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/technology-usage/security-technology-usage.windup.xml-0
    tag:
    - Sustain
    - Security
    - Java EE
    - Security Realm
    when:
    - or:
      - java.referenced:
          location: ANNOTATION
          pattern: javax.annotation.security.{*}
      - xml:
          XPath: //*[local-name() = 'login-config']/*[local-name() = 'realm-name']
          filepaths:
          - web.xml
      - xml:
          XPath: //*[local-name() = 'login-config']/*[local-name() = 'realm']
          filepaths:
          - '{*}ejb-jar.xml'
