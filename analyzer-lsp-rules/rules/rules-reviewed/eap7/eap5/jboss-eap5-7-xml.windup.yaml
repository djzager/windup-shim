- rules:
  - ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap5/jboss-eap5-7-xml.windup.xml-0
    tag:
    - cache
    - distributed
    - cluster
    - jboss-eap5
    when:
    - xml:
        XPath: //mbean[@code='org.jboss.cache.TreeCache']
  - ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap5/jboss-eap5-7-xml.windup.xml-1
    tag:
    - jboss-eap5
    when:
    - xml:
        XPath: ""
  - message: In JBoss EAP 6+, the classloading configuration is not done through `jboss-classloading.xml`..
      Since EAP 6 is of modular nature, based on JBoss Modules.. Learn how to divide
      your application's dependencies into modules. and what dependencies and APIs
      are available automatically.
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap5/jboss-eap5-7-xml.windup.xml-2
    when:
    - xml:
        XPath: /jbc:classloading
  - ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap5/jboss-eap5-7-xml.windup.xml-3
    tag:
    - descriptor
    - jboss-eap5
    when:
    - xml:
        XPath: //*[local-name()='jboss']
        filepaths:
        - jboss.xml
  - message: '`java:/jaas/` is a JBoss EAP `security-domain` URI.. Remove the `java:/jaas/`
      prefix for `security-domain` elements in EAP 7/6.'
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap5/jboss-eap5-7-xml.windup.xml-4
    when:
    - xml:
        XPath: //*[local-name()='security-domain' and starts-with(text(), 'java:/jaas/')]
  - message: Before JBoss EAP 6, authentication security domains and login modules
      could be configured in a `login-config.xml` file.. JBoss EAP 6+ does not support
      the `login-config.xml` descriptor. Security is now configured inside the server
      configuration. Please refer to the corresponding server security guide.
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap5/jboss-eap5-7-xml.windup.xml-5
    when:
    - xml:
        XPath: //*[local-name()='policy']
        filepaths:
        - login-config.xml
