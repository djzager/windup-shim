- rules:
  - message: "\n                        Default Remote JNDI Provider URL has changed
      in EAP 7. External applications using JNDI to lookup remote resources, for instance
      an EJB or a JMS Queue,\n                        may need to change the value
      for the JNDI InitialContext environment's property named `java.naming.provider.url`.\n
      \                       The default URL scheme is now **http-remoting** instead
      of **remote**, and the default URL port is now **8080** instead of **4447**.\n\n
      \                       As an example, consider the application server host
      is localhost, then clients previously accessing EAP 6 would use\n\n                        ```\n
      \                       java.naming.factory.initial=org.jboss.naming.remote.client.InitialContextFactory\n
      \                       java.naming.provider.url=remote://localhost:4447\n                        ```\n\n
      \                       while clients now accessing EAP 7 should use instead\n\n
      \                       ```\n                        java.naming.factory.initial=org.jboss.naming.remote.client.InitialContextFactory\n
      \                       java.naming.provider.url=http-remoting://localhost:8080\n
      \                       ```\n\n                    "
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap6/eap6.windup.xml-0
    when:
    - filecontent:
        filename: '{*}.{extension}'
        pattern: remote://{node}:{port}
  - message: "\n                        The default remote connection port has changed
      in **jboss-ejb-client.properties** from '4447' to '8080'.\n\n                        In
      EAP 6, the jboss-ejb-client.properties file looked similar to the following:\n\n
      \                       ```\n                        remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false\n
      \                       remote.connections=default\n                        remote.connection.default.host=localhost\n
      \                       remote.connection.default.port=4447\n                        remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false\n
      \                       ```\n\n                        In EAP 7, the properties
      file looks like this:\n\n                        ```\n                        remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false\n
      \                       remote.connections=default\n                        remote.connection.default.host=localhost\n
      \                       remote.connection.default.port=8080\n                        remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false\n
      \                       ```\n\n                    "
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap6/eap6.windup.xml-1
    when:
    - filecontent:
        filename: jboss-ejb-client.properties
        pattern: remote.connection.{*}.port{portnumber}
  - message: "\n                        The default remote connection port has changed
      from '4447' to '8080'.\n\n                        In EAP 6, Remote EJB client
      Java code looks like the following:\n\n                        ```java\n                        Properties
      properties = new Properties();\n                        properties.put(\"remote.connection.default.port\",
      \"4447\");\n                        ```\n\n                        In EAP 7,
      the Java client code looks like this:\n\n                        ```java\n                        Properties
      properties = new Properties();\n                        properties.put(\"remote.connection.default.port\",
      \"8080\");\n                        ```\n\n                    "
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap6/eap6.windup.xml-2
    when:
    - filecontent:
        filename: '{*}.java'
        pattern: remote.connection.{*}.port{portnumber}
  - message: "\n                        The value of JSF constant `FaceletContext.FACELET_CONTEXT_KEY`
      has changed between JSF 2.1 and 2.2.\n                        The variable is
      a compile-time constant expression, so when the program was originally compiled,\n
      \                       the reference to `FACELET_CONTEXT_KEY` was replaced
      by its value during compilation.\n                        The application must
      be recompiled so that the reference to `FACELET_CONTEXT_KEY` is replaced by
      its new value.\n                    "
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap6/eap6.windup.xml-3
    when:
    - or:
      - filecontent:
          filename: '{*}.java'
          pattern: com.sun.faces.facelets.FACELET_CONTEXT
      - filecontent:
          filename: '{*}.java'
          pattern: FaceletContext.FACELET_CONTEXT_KEY
  - message: "In EAP 6, you could disable the HTTPS URL hostname check against a serviceâ€™s
      Common Name (CN) given in its certificate by setting the system property `org.jboss.security.ignoreHttpsHost`
      to `true`. This system property name has been replaced with `cxf.tls-client.disableCNCheck`
      in EAP 7. \n                    "
    ruleID: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap6/eap6.windup.xml-4
    when:
    - filecontent:
        filename: '{*}.{extension}'
        pattern: org.jboss.security.ignoreHttpsHost
